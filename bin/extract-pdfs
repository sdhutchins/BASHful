#!/bin/bash
# ------------------------------------------------------------------
# [Shaurita D. Hutchins] extract-pdfs
#          This script extracts all .pdf files from a directory and its subdirectories
#          and copies them into a folder named 'all_pdfs'.
#          Usage: extract-pdfs [TARGET_DIR]
# ------------------------------------------------------------------

set -euo pipefail

# Use current directory if no argument provided
SEARCH_DIR="${1:-.}"
DEST_DIR="all_pdfs"

# Check if search directory exists
if [[ ! -d "$SEARCH_DIR" ]]; then
    echo "Error: Directory '$SEARCH_DIR' not found."
    exit 1
fi

# Create destination folder safely
mkdir -p "$DEST_DIR"

echo "Searching for PDFs in '$SEARCH_DIR'..."

# Find and copy .pdf files, excluding the destination folder itself to avoid infinite loops/duplication
# Using -exec cp is efficient. Added -v for verbose output (optional, can remove if too noisy)
find "$SEARCH_DIR" -type f -iname "*.pdf" \
    ! -path "./$DEST_DIR/*" \
    -exec cp -v "{}" "$DEST_DIR/" \;

echo "All PDF files copied to ./$DEST_DIR"
